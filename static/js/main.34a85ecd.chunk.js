(this["webpackJsonpreact-starter"]=this["webpackJsonpreact-starter"]||[]).push([[0],{22:function(e,t,a){e.exports=a(39)},26:function(e,t,a){},27:function(e,t,a){},35:function(e,t,a){},36:function(e,t,a){},37:function(e,t,a){},38:function(e,t,a){},39:function(e,t,a){"use strict";a.r(t);var n=a(3),c=a(0),r=a.n(c),s=a(14),i=a.n(s),l=a(6),u=a(2),o=(a(26),a(27),a(1)),d=(a(13),r.a.createContext({})),h=(a(35),function(e){var t=e.card,a=e.isFaceUp,s=e.player,i=e.isKnock,l=void 0!==i&&i,u=e.pile,h=Object(c.useState)(!1),m=Object(n.a)(h,2),f=m[0],p=m[1],v=Object(c.useContext)(d),b=v.discardPile,O=v.setDiscardPile,j=v.deck,E=v.setDeck,g=v.userPlayer,k=v.gameState,y=v.setGameState,M=v.players,w=v.currentCard,S=v.setCurrentCard;Object(c.useEffect)((function(){p(a)}),[]);var P=function(){0==M[0].calcDeadwood&&(M[0].score+=25+M[1].calcDeadwood(),M[0].score>=100?(alert("You win!"),window.location="/"):window.location="/chat")};return r.a.createElement(r.a.Fragment,null,t&&r.a.createElement("div",{className:"Card",onClick:function(e){return f?function(e){if(null==s&&"draw"==k){e.preventDefault(),g.hand.push(t);var a=Object(o.a)(b);a.splice(a.indexOf(t),1),O(a),y("discard")}if(s===g&&"discard"==k)if(e.preventDefault(),g.calcDeadwood()>10){var n=Object(o.a)(b);n.unshift(t),O(n),g.hand.splice(g.hand.indexOf(t),1),P(),y("opponent")}else y("knock-discard"),S(t);if("discard"==u.name&&"knock-discard"==k){var c=Object(o.a)(b);console.log("currentCard",w),c.unshift(w),O(c),g.hand.splice(g.hand.indexOf(w),1),P(),y("opponent")}}(e):function(e){if(null==s&&"draw"==k){e.preventDefault(),g.hand.push(t);var a=Object(o.a)(j);a.splice(a.indexOf(t),1),E(a),y("discard")}l&&"knock-discard"==k&&alert("knock")}(e)},style:{backgroundImage:l?"url('/card-images/knock.png')":'url("'.concat("."+"/card-images/".concat(f?function(e){var t;switch(e.value){case 1:t="A";break;case 11:t="J";break;case 12:t="Q";break;case 13:t="K";break;default:t=e.value}return"".concat(t).concat(e.suit[0].toUpperCase(),".png")}(t):"blue_back.png"),'")')}}))}),m=a(7),f=function e(t,a){Object(m.a)(this,e),this.suit=null,this.value=0,this.suit=t,this.value=a},p={HEARTS:"hearts",CLUBS:"clubs",SPADES:"spades",DIAMONDS:"diamonds"},v=a(21),b=function(){function e(t){Object(m.a)(this,e),this.name="",this.score=0,this.hand=[],this.possibleMelds=[],this.bestMelds=[],this.discardPile=[],this.deck=[],this.name=t}return Object(v.a)(e,[{key:"highestValueMeld",value:function(){var e=0,t=0,a=[],n=[];return this.possibleMelds.map((function(c,r,s){var i=0;c.map((function(e){var t=!1;a.map((function(a){a.card.value==e.value&&a.card.suit==e.suit&&(t=!0)})),t?a.map((function(t){t.card.value==e.value&&t.card.suit==e.suit&&t.count++})):a.push({card:e,count:1}),i+=e.value<11?e.value:10})),a.map((function(e){e.count>1&&n.push(e.card)}));var l=c.filter((function(e){return n.includes(e)})),u=i/(l.length>0?l.length:1);u>e&&(e=u,t=r)})),this.possibleMelds[t]}},{key:"checkHandForSets",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3;this.possibleMelds=[];var a=Object(o.a)(this.hand),n=a.filter((function(e){return"hearts"==e.suit})),c=a.filter((function(e){return"diamonds"==e.suit})),r=a.filter((function(e){return"clubs"==e.suit})),s=a.filter((function(e){return"spades"==e.suit}));n.sort((function(e,t){return e.value-t.value})),c.sort((function(e,t){return e.value-t.value})),r.sort((function(e,t){return e.value-t.value})),s.sort((function(e,t){return e.value-t.value})),a=[].concat(Object(o.a)(n),Object(o.a)(c),Object(o.a)(r),Object(o.a)(s));for(var i=function(a){var n=[],c=0;e.hand.map((function(e){e.value==a&&(n.push(e),c++)})),c>=t&&e.possibleMelds.push(n)},l=1;l<14;l++)i(l);var u=0,d=[];a.map((function(n,c,r){if(c!=a.length-1){var s=r[c+1];s.value==n.value+1&&s.suit==n.suit?(u++,d.push(n),c==a.length-2&&u>=3&&(d.push(s),d.length>0&&e.possibleMelds.push(d))):(u>=t&&(d.push(n),d.length>0&&e.possibleMelds.push(d)),u=0,d=[])}}))}},{key:"filterMelds",value:function(){var e=this.highestValueMeld();this.bestMelds.push(e);var t=Object(o.a)(this.possibleMelds);t.map((function(a,n){e.map((function(e){a.includes(e)&&t.splice(n,1)}))})),this.possibleMelds=t}},{key:"getMelds",value:function(){for(this.bestMelds=[],this.checkHandForSets();this.possibleMelds.length>0;)this.filterMelds()}},{key:"calcDeadwood",value:function(){var e=this;this.getMelds();var t=0;return this.hand.map((function(a){var n=!1;e.bestMelds.map((function(e){e.includes(a)&&(n=!0)})),n||(t+=a.value<11?a.value:10)})),t}},{key:"arrDiff",value:function(e,t){for(var a=[],n=[],c=0;c<e.length;c++)a[e[c]]=!0;for(c=0;c<t.length;c++)a[t[c]]?delete a[t[c]]:a[t[c]]=!0;for(var r in a)n.push(r);return n}},{key:"opponentTurn",value:function(){var e=this;if(this.getMelds(),0==this.calcDeadwood());else{this.checkHandForSets(2);var t,a,n=Object(o.a)(this.hand),c=this.discardPile[0];this.hand.push(c);var r=Object(o.a)(this.discardPile);r.splice(r.indexOf(c),1),this.getMelds(),t=this.possibleMelds.length,this.hand=Object(o.a)(n);var s=this.deck[0];if(this.hand.push(s),Object(o.a)(this.deck).splice(r.indexOf(s),1),this.getMelds(),a=this.possibleMelds.length,this.hand=Object(o.a)(n),t>a){var i=this.discardPile[0];this.hand.push(i);var l=Object(o.a)(this.discardPile);l.splice(l.indexOf(i),1),this.discardPile=Object(o.a)(l)}else if(a>t){var u=this.deck[0];this.hand.push(u);var d=Object(o.a)(this.deck);d.splice(r.indexOf(u),1),this.deck=Object(o.a)(d)}else if(this.deck[0].value>this.discardPile[0].value){var h=this.discardPile[0];this.hand.push(h);var m=Object(o.a)(this.discardPile);m.splice(m.indexOf(h),1),this.discardPile=Object(o.a)(m)}else{var f=this.deck[0];this.hand.push(f);var p=Object(o.a)(this.deck);p.splice(r.indexOf(f),1),this.deck=Object(o.a)(p)}this.getMelds();var v,b,O,j=Object(o.a)(this.hand).filter((function(t){return!e.possibleMelds.flat().includes(t)})),E=0;j.forEach((function(e){e.value>E&&(E=e.value,v=e)})),this.hand.forEach((function(e,t){e.value==v.value&&e.suit==v.suit&&(b=t,O=e)})),this.discardPile.unshift(O),this.hand.splice(b,1)}return"draw"}}]),e}(),O=(a(36),a(37),function(){var e=Object(u.f)(),t=Object(c.useContext)(d),a=t.playerName,n=t.setPlayerName,s=t.isFindingGame,i=t.setIsFindingGame;return r.a.createElement("div",{className:"Lobby"},r.a.createElement("h1",null,"Online Gin-Rummy"),s?r.a.createElement("h2",{className:"loading"},"Searching..."):r.a.createElement("form",{onSubmit:function(t){return function(t){t.preventDefault(),n(a),i(!0);var c=1e3*Math.floor(1*Math.random());setTimeout((function(){e.push("/chat")}),c)}(t)},className:"nameForm"},r.a.createElement("label",{htmlFor:"name"},"Enter your name"),r.a.createElement("input",{type:"text",name:"name",id:"nameField",placeholder:"Name",value:a,onChange:function(e){n(e.target.value)}}),r.a.createElement("input",{type:"submit",value:"Find Game"})))}),j=[],E=function(){var e=Object(c.useState)([]),t=Object(n.a)(e,2),a=t[0],s=t[1],i=Object(c.useState)([]),l=Object(n.a)(i,2),u=l[0],m=l[1],v=Object(c.useState)(!1),O=Object(n.a)(v,2),E=O[0],g=O[1],k=Object(c.useContext)(d),y=k.gameState,M=k._setGameState,w=k.prevGameState,S=k.setPrevGameState,P=(k.playerName,k.setPlayerName,Object(c.useState)()),N=Object(n.a)(P,2),D=N[0],x=N[1],C=function(e){S(y),M(e)},F=Object(c.useRef)();return Object(c.useEffect)((function(){!function(){var e=[];Object.keys(p).map((function(t){for(var a=1;a<14;a++){var n=new f(t,a);e.push(n)}})),s(e)}(),j=[new b("Player 1"),new b("Player 2")],setTimeout((function(){F&&F.current.click()}),100)}),[]),Object(c.useEffect)((function(){"opponent"==w&&(s(Object(o.a)(j[1].deck)),m(Object(o.a)(j[1].discardPile))),"opponent"==y&&setTimeout((function(){C(j[1].opponentTurn())}),1e3)}),[y]),Object(c.useEffect)((function(){j.forEach((function(e){e.discardPile=Object(o.a)(u),e.deck=Object(o.a)(a)}))}),[u,a]),Object(c.useEffect)((function(){0==j[1].calcDeadwood&&(j[1].score+=25+j[0].calcDeadwood(),j[1].score>=100?(alert("You lost :("),window.location="/"):window.location="/chat")}),[y]),r.a.createElement(d.Provider,{value:{discardPile:u,setDiscardPile:m,deck:a,setDeck:s,userPlayer:j[0],gameState:y,setGameState:C,players:j,currentCard:D,setCurrentCard:x}},r.a.createElement("div",{className:"Home"},!E&&r.a.createElement("button",{onClick:function(e){e.preventDefault(),g(!0),function(){for(var e=Object(o.a)(a),t=0;t<20;t++){for(var n=Object(o.a)(e),c=Math.floor(Math.random()*n.length-1);-1==c;)c=Math.floor(Math.random()*n.length-1);var r=n[c];j[t%2].hand.push(r),n.splice(c,1),e=Object(o.a)(n)}s(e.sort((function(){return.5-Math.random()})));for(var i=Object(o.a)(e),l=Math.floor(Math.random()*i.length-1);-1==l;)l=Math.floor(Math.random()*i.length-1);m([i[l]]),i.splice(l,1),e=Object(o.a)(i),C("draw")}()},id:"dealBtn",ref:F},"Loading"),j[1]&&r.a.createElement("h2",null,j[1].name," Score: ",j[1].score),r.a.createElement("div",{className:"cardList"},j[1]&&j[1].hand.map((function(e,t){return r.a.createElement(h,{card:e,isFaceUp:!1,player:j[1],pile:{name:"opponentHand",ref:j[1].hand}})}))),r.a.createElement("br",null),r.a.createElement("div",{className:"middleDeck ".concat("opponent"==y?"greyedOut":"")},r.a.createElement("div",{className:"cardWrapper"},r.a.createElement("img",{className:"Card",src:"./card-images/knock.png",alt:"knock"})),r.a.createElement("div",{className:"cardWrapper"},r.a.createElement(h,{card:a[0],isFaceUp:!1,player:null,pile:{name:"deck",ref:a}})),r.a.createElement("div",{className:"cardWrapper"},u.length>0?r.a.createElement(h,{card:u[0],isFaceUp:!0,player:null,pile:{name:"discard",ref:u}}):r.a.createElement(h,{card:a[0],isFaceUp:!0,player:null,pile:{name:"discard",ref:a[0]}}))),r.a.createElement("br",null),r.a.createElement("div",{className:"cardList ".concat("opponent"==y?"greyedOut":"")},j[0]&&j[0].hand.map((function(e,t){return r.a.createElement(h,{card:e,isFaceUp:!0,player:j[0],pile:{name:"hand",ref:j[0].hand}})}))),r.a.createElement("h2",{className:"gameState"},y?function(e){switch(e){case"draw":return"Draw Card";case"discard":return"Discard";case"opponent":return"".concat(j[1].name,"'s turn");default:return e}}(y):""),j[0]&&r.a.createElement("div",{className:"player1Score"},r.a.createElement("h2",null,j[0].name," Score: ",j[0].score),r.a.createElement("div",{style:{flexGrow:1}}),r.a.createElement("h2",null,"Deadwood: ",j[0].calcDeadwood(),"/10"))))},g=(a(38),function e(t,a){Object(m.a)(this,e),this.sender=t,this.text=a,this.timestamp=Date.now()}),k=function(){var e=Object(u.f)(),t=Object(c.useContext)(d),a=t.playerName,s=(t.setPlayerName,t.isFindingGame,t.setIsFindingGame,Object(c.useState)([])),i=Object(n.a)(s,2),l=i[0],h=i[1],m=Object(c.useState)(""),f=Object(n.a)(m,2),p=f[0],v=f[1],b=Object(c.useState)(!0),O=Object(n.a)(b,2);O[0],O[1];Object(c.useEffect)((function(){console.log(l)}),[l]);return Object(c.useEffect)((function(){var t=2,a=0,n=setInterval((function(){if(0==t&&0==a)e.push("/play"),clearInterval(n);else if(document.getElementById("timer").innerHTML="Round starting in ".concat(t," minutes and ").concat(a," seconds"),--a<0&&(t--,a=59),a%10==0){var c=new g("Fake User","Fake user message");h((function(e){return[].concat(Object(o.a)(e),[c])}))}}),1e3)}),[]),r.a.createElement(d.Provider,{value:{playerName:a}},r.a.createElement("div",{className:"Chat"},r.a.createElement("h1",null,"Online Gin-Rummy"),r.a.createElement("h2",null,"Chat"),r.a.createElement("h2",{id:"timer"},"..."),r.a.createElement("div",{className:"message-area"},r.a.createElement("ul",null,l.map((function(e){return r.a.createElement("div",{className:"message ".concat(e.sender===a?"ownMessage":"")},r.a.createElement("h3",null,e.sender),r.a.createElement("p",null,e.text))}))),r.a.createElement("div",{className:"spacer"}),r.a.createElement("form",{onSubmit:function(e){return function(e){e.preventDefault();var t=new g(a,p);h([].concat(Object(o.a)(l),[t])),v("")}(e)}},r.a.createElement("textarea",{type:"text",name:"message",id:"message-box",placeholder:"Message",value:p,onChange:function(e){return function(e){e.preventDefault(),v(e.target.value)}(e)}}),r.a.createElement("input",{type:"submit",value:"Send",disabled:""===p})))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var y=function(){var e=Object(c.useState)(null),t=Object(n.a)(e,2),a=t[0],s=t[1],i=Object(c.useState)(""),o=Object(n.a)(i,2),h=o[0],m=o[1],f=Object(c.useState)("Player 1"),p=Object(n.a)(f,2),v=p[0],b=p[1],j=Object(c.useState)(!1),g=Object(n.a)(j,2),y=g[0],M=g[1];return r.a.createElement(d.Provider,{value:{gameState:a,_setGameState:s,prevGameState:h,setPrevGameState:m,playerName:v,setPlayerName:b,isFindingGame:y,setIsFindingGame:M}},r.a.createElement(l.a,{basename:"/"},r.a.createElement("div",{className:"container"},r.a.createElement(u.c,null,r.a.createElement(u.a,{exact:!0,path:"/"},r.a.createElement(O,null)),r.a.createElement(u.a,{exact:!0,path:"/chat"},r.a.createElement(k,null)),r.a.createElement(u.a,{exact:!0,path:"/play"},r.a.createElement(E,null))))))};i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(y,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[22,1,2]]]);
//# sourceMappingURL=main.34a85ecd.chunk.js.map