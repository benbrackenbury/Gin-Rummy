(this["webpackJsonpreact-starter"]=this["webpackJsonpreact-starter"]||[]).push([[0],{22:function(e,t,a){e.exports=a(38)},26:function(e,t,a){},27:function(e,t,a){},35:function(e,t,a){},36:function(e,t,a){},37:function(e,t,a){},38:function(e,t,a){"use strict";a.r(t);var n=a(4),c=a(0),s=a.n(c),i=a(13),r=a.n(i),l=a(6),u=a(2),o=(a(26),a(27),a(1)),d=(a(19),s.a.createContext({})),h=(a(35),function(e){var t=e.card,a=e.isFaceUp,i=e.player,r=e.isKnock,l=void 0!==r&&r,u=e.pile,h=Object(c.useState)(!1),f=Object(n.a)(h,2),p=f[0],m=f[1],v=Object(c.useContext)(d),b=v.discardPile,O=v.setDiscardPile,j=v.deck,g=v.setDeck,k=v.userPlayer,E=v.gameState,M=v.setGameState,y=(v.players,v.currentCard),S=v.setCurrentCard;Object(c.useEffect)((function(){m(a)}),[]);return s.a.createElement(s.a.Fragment,null,t&&s.a.createElement("div",{className:"Card",onClick:function(e){return p?function(e){if(null==i&&"draw"==E){e.preventDefault(),k.hand.push(t);var a=Object(o.a)(b);a.splice(a.indexOf(t),1),O(a),M("discard")}if(i===k&&"discard"==E)if(e.preventDefault(),k.calcDeadwood()>10){var n=Object(o.a)(b);n.unshift(t),O(n),k.hand.splice(k.hand.indexOf(t),1),M("opponent")}else M("knock-discard"),S(t);if("discard"==u.name&&"knock-discard"==E){var c=Object(o.a)(b);console.log("currentCard",y),c.unshift(y),O(c),k.hand.splice(k.hand.indexOf(y),1),M("opponent")}}(e):function(e){if(null==i&&"draw"==E){e.preventDefault(),k.hand.push(t);var a=Object(o.a)(j);a.splice(a.indexOf(t),1),g(a),M("discard")}l&&"knock-discard"==E&&alert("knock")}(e)},style:{backgroundImage:l?"url('/card-images/knock.png')":'url("'.concat("."+"/card-images/".concat(p?function(e){var t;switch(e.value){case 1:t="A";break;case 11:t="J";break;case 12:t="Q";break;case 13:t="K";break;default:t=e.value}return"".concat(t).concat(e.suit[0].toUpperCase(),".png")}(t):"blue_back.png"),'")')}}))}),f=a(10),p=function e(t,a){Object(f.a)(this,e),this.suit=null,this.value=0,this.suit=t,this.value=a},m={HEARTS:"hearts",CLUBS:"clubs",SPADES:"spades",DIAMONDS:"diamonds"},v=a(21),b=function(){function e(t){Object(f.a)(this,e),this.name="",this.score=0,this.hand=[],this.possibleMelds=[],this.bestMelds=[],this.discardPile=[],this.deck=[],this.name=t}return Object(v.a)(e,[{key:"highestValueMeld",value:function(){var e=0,t=0,a=[],n=[];return this.possibleMelds.map((function(c,s,i){var r=0;c.map((function(e){var t=!1;a.map((function(a){a.card.value==e.value&&a.card.suit==e.suit&&(t=!0)})),t?a.map((function(t){t.card.value==e.value&&t.card.suit==e.suit&&t.count++})):a.push({card:e,count:1}),r+=e.value<11?e.value:10})),a.map((function(e){e.count>1&&n.push(e.card)}));var l=c.filter((function(e){return n.includes(e)})),u=r/(l.length>0?l.length:1);u>e&&(e=u,t=s)})),this.possibleMelds[t]}},{key:"checkHandForSets",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3;this.possibleMelds=[];var a=Object(o.a)(this.hand),n=a.filter((function(e){return"hearts"==e.suit})),c=a.filter((function(e){return"diamonds"==e.suit})),s=a.filter((function(e){return"clubs"==e.suit})),i=a.filter((function(e){return"spades"==e.suit}));n.sort((function(e,t){return e.value-t.value})),c.sort((function(e,t){return e.value-t.value})),s.sort((function(e,t){return e.value-t.value})),i.sort((function(e,t){return e.value-t.value})),a=[].concat(Object(o.a)(n),Object(o.a)(c),Object(o.a)(s),Object(o.a)(i));for(var r=function(a){var n=[],c=0;e.hand.map((function(e){e.value==a&&(n.push(e),c++)})),c>=t&&e.possibleMelds.push(n)},l=1;l<14;l++)r(l);var u=0,d=[];a.map((function(n,c,s){if(c!=a.length-1){var i=s[c+1];i.value==n.value+1&&i.suit==n.suit?(u++,d.push(n),c==a.length-2&&u>=3&&(d.push(i),d.length>0&&e.possibleMelds.push(d))):(u>=t&&(d.push(n),d.length>0&&e.possibleMelds.push(d)),u=0,d=[])}}))}},{key:"filterMelds",value:function(){var e=this.highestValueMeld();this.bestMelds.push(e);var t=Object(o.a)(this.possibleMelds);t.map((function(a,n){e.map((function(e){a.includes(e)&&t.splice(n,1)}))})),this.possibleMelds=t}},{key:"getMelds",value:function(){for(this.bestMelds=[],this.checkHandForSets();this.possibleMelds.length>0;)this.filterMelds()}},{key:"calcDeadwood",value:function(){var e=this;this.getMelds();var t=0;return this.hand.map((function(a){var n=!1;e.bestMelds.map((function(e){e.includes(a)&&(n=!0)})),n||(t+=a.value<11?a.value:10)})),t}},{key:"endRound",value:function(){alert("end")}},{key:"arrDiff",value:function(e,t){for(var a=[],n=[],c=0;c<e.length;c++)a[e[c]]=!0;for(c=0;c<t.length;c++)a[t[c]]?delete a[t[c]]:a[t[c]]=!0;for(var s in a)n.push(s);return n}},{key:"opponentTurn",value:function(){var e=this;if(console.log("deck (player)",this.deck),this.getMelds(),0==this.calcDeadwood())this.endRound();else{this.checkHandForSets(2);var t,a,n=Object(o.a)(this.hand),c=this.discardPile[0];this.hand.push(c);var s=Object(o.a)(this.discardPile);s.splice(s.indexOf(c),1),this.getMelds(),t=this.possibleMelds.length,console.log("discard",this.possibleMelds.length),this.hand=Object(o.a)(n);var i=this.deck[0];if(this.hand.push(i),Object(o.a)(this.deck).splice(s.indexOf(i),1),this.getMelds(),a=this.possibleMelds.length,console.log("deck",this.possibleMelds.length),this.hand=Object(o.a)(n),t>a){var r=this.discardPile[0];this.hand.push(r);var l=Object(o.a)(this.discardPile);l.splice(l.indexOf(r),1),this.discardPile=Object(o.a)(l)}else if(a>t){var u=this.deck[0];this.hand.push(u);var d=Object(o.a)(this.deck);d.splice(s.indexOf(u),1),this.deck=Object(o.a)(d)}else if(this.deck[0].value>this.discardPile[0].value){var h=this.discardPile[0];this.hand.push(h);var f=Object(o.a)(this.discardPile);f.splice(f.indexOf(h),1),this.discardPile=Object(o.a)(f)}else{var p=this.deck[0];this.hand.push(p);var m=Object(o.a)(this.deck);m.splice(s.indexOf(p),1),this.deck=Object(o.a)(m)}this.getMelds();var v,b,O,j=Object(o.a)(this.hand).filter((function(t){return!e.possibleMelds.flat().includes(t)})),g=0;j.forEach((function(e){e.value>g&&(g=e.value,v=e)})),this.hand.forEach((function(e,t){e.value==v.value&&e.suit==v.suit&&(b=t,O=e)})),this.discardPile.unshift(O),this.hand.splice(b,1)}return"draw"}}]),e}(),O=(a(36),a(37),function(){var e=Object(c.useContext)(d),t=e.playerName,a=e.setPlayerName,n=e.isFindingGame,i=e.setIsFindingGame;return s.a.createElement("div",{className:"Lobby"},s.a.createElement("h1",null,"Online Gin-Rummy"),n?s.a.createElement("h2",{className:"loading"},"Searching..."):s.a.createElement("form",{onSubmit:function(e){return function(e){e.preventDefault(),a(t),i(!0);var n=1e3*Math.floor(1*Math.random());setTimeout((function(){window.location="/#/play"}),n)}(e)},className:"nameForm"},s.a.createElement("label",{htmlFor:"name"},"Enter your name"),s.a.createElement("input",{type:"text",name:"name",id:"nameField",placeholder:"Name",value:t,onChange:function(e){a(e.target.value)}}),s.a.createElement("input",{type:"submit",value:"Find Game"})))}),j=[],g=function(){var e=Object(c.useState)([]),t=Object(n.a)(e,2),a=t[0],i=t[1],r=Object(c.useState)([]),l=Object(n.a)(r,2),u=l[0],f=l[1],v=Object(c.useState)(!1),O=Object(n.a)(v,2),g=O[0],k=O[1],E=Object(c.useContext)(d),M=E.gameState,y=E._setGameState,S=E.prevGameState,P=E.setPrevGameState,w=E.playerName,N=(E.setPlayerName,Object(c.useState)()),D=Object(n.a)(N,2),x=D[0],C=D[1],F=function(e){P(M),y(e)};return Object(c.useEffect)((function(){!function(){var e=[];Object.keys(m).map((function(t){for(var a=1;a<14;a++){var n=new p(t,a);e.push(n)}})),i(e)}(),j=[new b("Player 1"),new b("Player 2")]}),[]),Object(c.useEffect)((function(){"opponent"==S&&(i(Object(o.a)(j[1].deck)),f(Object(o.a)(j[1].discardPile))),"opponent"==M&&setTimeout((function(){F(j[1].opponentTurn())}),1e3)}),[M]),Object(c.useEffect)((function(){j.forEach((function(e){e.discardPile=Object(o.a)(u),e.deck=Object(o.a)(a)}))}),[u,a]),s.a.createElement(d.Provider,{value:{discardPile:u,setDiscardPile:f,deck:a,setDeck:i,userPlayer:j[0],gameState:M,setGameState:F,players:j,currentCard:x,setCurrentCard:C}},s.a.createElement("div",{className:"Home"},!g&&s.a.createElement("button",{onClick:function(e){e.preventDefault(),k(!0),function(){for(var e=Object(o.a)(a),t=0;t<20;t++){for(var n=Object(o.a)(e),c=Math.floor(Math.random()*n.length-1);-1==c;)c=Math.floor(Math.random()*n.length-1);var s=n[c];j[t%2].hand.push(s),n.splice(c,1),e=Object(o.a)(n)}i(e.sort((function(){return.5-Math.random()})));for(var r=Object(o.a)(e),l=Math.floor(Math.random()*r.length-1);-1==l;)l=Math.floor(Math.random()*r.length-1);f([r[l]]),r.splice(l,1),e=Object(o.a)(r),F("draw")}()}},"Deal"),s.a.createElement("h2",null,"Name: ",w||"null","; ",M||"null",", deadwood: ",j[0]&&j[0].calcDeadwood()),s.a.createElement("div",{className:"cardList"},j[1]&&j[1].hand.map((function(e,t){}))),s.a.createElement("br",null),s.a.createElement("div",{className:"middleDeck ".concat("opponent"==M?"greyedOut":"")},s.a.createElement("div",{className:"cardWrapper"},s.a.createElement("img",{className:"Card",src:"/card-images/knock.png",alt:"knock"})),s.a.createElement("div",{className:"cardWrapper"},s.a.createElement(h,{card:a[0],isFaceUp:!1,player:null,pile:{name:"deck",ref:a}})),s.a.createElement("div",{className:"cardWrapper"},u.length>0?s.a.createElement(h,{card:u[0],isFaceUp:!0,player:null,pile:{name:"discard",ref:u}}):s.a.createElement(h,{card:a[0],isFaceUp:!0,player:null,pile:{name:"discard",ref:a[0]}}))),s.a.createElement("br",null),s.a.createElement("div",{className:"cardList ".concat("opponent"==M?"greyedOut":"")},j[0]&&j[0].hand.map((function(e,t){})))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var k=function(){var e=Object(c.useState)(null),t=Object(n.a)(e,2),a=t[0],i=t[1],r=Object(c.useState)(""),o=Object(n.a)(r,2),h=o[0],f=o[1],p=Object(c.useState)("Player 1"),m=Object(n.a)(p,2),v=m[0],b=m[1],j=Object(c.useState)(!1),k=Object(n.a)(j,2),E=k[0],M=k[1];return s.a.createElement(d.Provider,{value:{gameState:a,_setGameState:i,prevGameState:h,setPrevGameState:f,playerName:v,setPlayerName:b,isFindingGame:E,setIsFindingGame:M}},s.a.createElement(l.a,null,s.a.createElement("div",{className:"container"},s.a.createElement(u.c,null,s.a.createElement(u.a,{exact:!0,path:"/"},s.a.createElement(O,null)),s.a.createElement(u.a,{exact:!0,path:"/play"},s.a.createElement(g,null))))))};r.a.render(s.a.createElement(s.a.StrictMode,null,s.a.createElement(k,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[22,1,2]]]);
//# sourceMappingURL=main.44ee18e7.chunk.js.map